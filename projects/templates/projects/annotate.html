{% extends "base.html" %}

{% block content %}

<h3>{{ project.name }}</h3>

{% if dataitem %}
  <div class="card mb-3">
    <div class="card-body">
      <p>{{ dataitem.text }}</p>
    </div>
  </div>

  <form method="post">
    {% csrf_token %}
    <div class="mb-3">
      {% for label in project.label_set.all %}
        {% if project.label_type == "SI" %}
          <div class="form-check">
            <input class="form-check-input"
                   type="radio"
                   name="labels"
                   id="label{{ forloop.counter }}"
                   value="{{ label.id }}">
            <label class="form-check-label" for="label{{ forloop.counter }}">
              {{ label.label }} <span class="text-muted small">(Hotkey: {{ forloop.counter }})</span>

            </label>
          </div>
        {% else %}
          <div class="form-check">
            <input class="form-check-input"
                   type="checkbox"
                   name="labels"
                   id="label{{ forloop.counter }}"
                   value="{{ label.id }}">
            <label class="form-check-label" for="label{{ forloop.counter }}">
              {{ label.label }} <span class="text-muted small">(Hotkey: {{ forloop.counter }})</span>
            </label>
          </div>
        {% endif %}
      {% endfor %}
    </div>

    <button type="submit" class="btn btn-primary">Save Annotation</button>
  </form>

  <div class="mt-3">
    <p>
      Progress: {{ annotated_by_user }} / {{ total_needed }} required annotations.
    </p>
    <div class="progress">
      <div class="progress-bar" role="progressbar"
           style="width: {{ progress_percent }}%;"
           aria-valuenow="{{ annotated_by_user }}"
           aria-valuemin="0"
           aria-valuemax="{{ total_needed }}">
      </div>
    </div>
  </div>

{% else %}
  <div class="alert alert-success">
    All texts have already been fully annotated.
  </div>
{% endif %}
<script>
document.addEventListener('keydown', function(event) {
  const key = parseInt(event.key);
  if (key >= 1 && key <= 9) {
    const input = document.getElementById('label' + key);
    if (input) {
      if (input.type === "radio") {
        input.checked = true;
      } else if (input.type === "checkbox") {
        input.checked = !input.checked;
      }
    }
  }
});
</script>

{% endblock %}
